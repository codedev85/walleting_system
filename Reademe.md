**Wallet System Setup installation**


**SETUP:**

1) Add Database configuration in your .env
2) run php artisan migrate --seed
3) Admin credentials will be displayed on the terminal after seeding
4) run php artisan queue:work ( for emails )
5) add SMTP credentials in your .env
6) Add Paystack secret keys , public keys and other credentials necessary for paystack to work in .env

**EXTRA SETUP:**

There are three custom-made artisan command that would work out of the box is the project is being hosted and supervisor is installed on the server to monitor cron job activity

1) **php artisan invalidate:otp** 

    This invalidates email verification OTP after 15 minutes, it runs every 15minutes

2) **php artisan invalidate:withdrawal-pin** 

    This invalidates withdrawal pin after 15 minutes if not used , it runs every 15minutes ;

3) **php artisan logout:in-active-users** 

    This runs every minute to logout inactive users after 2minutes of being in-active , although I feel the better approach would have been a case where the client side handles this 

**Bank Setup:**

 Users need to choose from an array list of bank that will be provided from the through an endpoint
 We need to load all banks in Nigeria from paystack

 This endpoint needs to be run on the browser 

 **Web url: https://walleting_system.test/load-banks**

 Where **https://walleting_system.test** is a base url of my setup installation. This could change depending on local installation setup

**Withdrawal Sequences:**

I am using two methods to allow user to withdraw funds from their wallet to their bank ,if one of the method is being used the other method is not needed

Webhook method works without any other input , once properly setup ,transaction record will be added in the database and the user will be credited

Reference method involves the frontend engineer passing the reference generated by paystack from initializing a payment , if you decide to go for this method do not add  url in the webhook section of paystack

1) **Webhook Method**

    Web hook method requires a ssl protected url to be added to paystack webhook url section on their portal.
    i was able to do this using **ngrok** which generated a temporal or fake url for me.
    After setting up **ngrok** on your machine 
    run **php artisan serve**  also run **ngrok http 8000**
    Note: 8000 is the port where the local instance is currently running
    if this works you don't need to use the second method.
    Also Note **ngrok** may only work with the internet used to set it up
    you may want to consider using the same internet everytime you decide to run this command

2) **Reference Method**

    This is simply passing a reference generated by paystack to  url to query if the payment was successful , if the payment was successful , then the user transaction record will be recorded on the app

**Documentation Url** 

https://codedev85.gitbook.io/walleting-system-documentation/

**PHP UNIT TESTING**

  Run php artisan test

**Notice**

While trying to withdraw funds from wallet to the bank , you need to test with correct bank details e.g. Bank ID  and account number , else you will get an error message

**Error Response** : Could not resolve bank issuer
